<!doctype html><html lang=en data-mode=dark><head prefix="og: http://ogp.me/ns#"><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=generator content="Hugo 0.120.4"><meta name=theme content="Color Your World -- gitlab.com/rmaguiar/hugo-theme-color-your-world"><title>Dirac Solver | Topological 4-Geon Theory Unchained</title>
<meta name=author content="Bijou M. Smith"><meta name=robots content="index follow"><link rel=canonical href=https://t4gu.gitlab.io/t4gu/theory/101_diracpp/><meta property="og:site_name" content="Topological 4-Geon Theory Unchained"><meta property="og:title" content="Dirac Solver"><meta property="og:url" content="https://t4gu.gitlab.io/t4gu/theory/101_diracpp/"><meta property="og:type" content="website"><meta name=twitter:dnt content="on"><meta name=theme-color content="#222"><meta name=apple-mobile-web-app-capable content="yes"><meta name=apple-mobile-web-app-status-bar-style content="default"><script type=application/ld+json>{"@context":"https://schema.org","@type":"WebSite","url":"https://t4gu.gitlab.io/t4gu","inLanguage":"en","name":"Topological 4-Geon Theory Unchained","description":"Geon Theory Development","publisher":"Bijou M. Smith"}</script><link rel=stylesheet href=https://t4gu.gitlab.io/t4gu/css/main.min.d33233e3d0eb633ea1fbb9e17553fe7c8ff07875b91d8186e046a48480987c8e.css integrity="sha256-0zIz49DrYz6h+7nhdVP+fI/weHW5HYGG4EakhICYfI4=" crossorigin=anonymous><noscript><meta name=theme-color content="#26A269"><link rel=stylesheet href=https://t4gu.gitlab.io/t4gu/css/noscript.min.503f912ad7e7391597c629c1f7134b77fa61b200f7425671b8fbbe91f62ad657.css integrity="sha256-UD+RKtfnORWXxinB9xNLd/phsgD3QlZxuPu+kfYq1lc=" crossorigin=anonymous></noscript><link rel=preload href=/t4gu/fonts/OpenSans-Bold.ttf as=font crossorigin=anonymous><link rel=preload href=/t4gu/fonts/OpenSans-Italic.ttf as=font crossorigin=anonymous><link rel=preload href=/t4gu/fonts/OpenSans-Regular.ttf as=font crossorigin=anonymous><link rel=preload href=/t4gu/fonts/Oswald-Bold.ttf as=font crossorigin=anonymous><link rel=preload href=/libs/katex@0.16.0/dist/fonts/KaTeX_Main-Regular.woff2 as=font type=font/woff2 crossorigin=anonymous><link rel=preload href=/libs/katex@0.16.0/dist/fonts/KaTeX_Math-Italic.woff2 as=font type=font/woff2 crossorigin=anonymous><link rel=preload href=/libs/katex@0.16.0/dist/fonts/KaTeX_Size2-Regular.woff2 as=font type=font/woff2 crossorigin=anonymous><link rel=preload href=/libs/katex@0.16.0/dist/fonts/KaTeX_Size4-Regular.woff2 as=font type=font/woff2 crossorigin=anonymous><script src=https://t4gu.gitlab.io/t4gu/js/main.6bc16541f8ff648cb50eea8924e00b94561cf02ec5b5c22ae4b3bce8bab38233.js integrity="sha256-a8FlQfj/ZIy1DuqJJOALlFYc8C7FtcIq5LO86LqzgjM=" crossorigin=anonymous></script></head><body><header><a href=/t4gu><img src=https://t4gu.gitlab.io/t4gu/images/t4gu_logo.svg alt="T4GU logo" style=display:flex;width:40px;height:34px;float:left;margin-bottom:-2.5px;margin-right:10px> </a><a href=/t4gu>Topological 4-Geon Theory Unchained</a><nav aria-label="Main menu."><ul><li><a class=btn href=/t4gu/>Home</a></li><li><a class=btn href=/t4gu/philosophy/>Philosophy</a></li><li><a class=btn href=/t4gu/theory/>Theory</a></li><li><a class=btn href=/t4gu/blog/>Posts</a></li><li><a class=btn href=/t4gu/contact/>Contact</a></li><li><a class=btn href=/t4gu/donations/>Donate</a></li></ul></nav></header><div class=filler><main><article><header><h1>Dirac Solver</h1><p>Last updated on <time datetime=2019-02-03>2019-02-03</time></p></header><details class=toc open><summary class=outline-dashed>Contents</summary><nav id=TableOfContents><ul><li><a href=#the-dirac-code>The dirac++ code</a><ul><li><a href=#pair-production-in-oscillating-em-field>Pair Production in Oscillating EM Field</a></li><li><a href=#todo>todo</a></li></ul></li><li><a href=#caveats>Caveats</a></li></ul></nav></details><p>The generally advised method for exploiting geometric algebra spinors to
numerically solve the Dirac equation is to advance the wave-function in
frequency space.</p><p>The spinor is after all a field with multivector values defined across all
space. The solution can then be advanced via a Fourier Transform with a time
update.</p><h2 id=the-dirac-code><a class=anchor href=#the-dirac-code title='Anchor for: The dirac++ code.'><svg aria-hidden="true"><use xlink:href="/t4gu/img/bundle.min.fc89b321aa39dfb355170fc007ce5b94.svg#hashtag"/></svg></a>The dirac++ code</h2><p>Doran, Gull, Lasenby and Somaroo developed a geometric algebra solver in the 1990&rsquo;s
but their code is not available. However,
<a href=http://dx.doi.org/10.1016/j.cpc.2008.01.042 target=_blank>Mocken and Keitel</a>
published a
GA based FFT Dirac solver in 2008, which is happily recent enough that it complies
on GNU/Linux.</p><p>First download the code here: <a href=https://prod-dcd-datasets-cache-zipfiles.s3.eu-west-1.amazonaws.com/43v3vvkwwf-1.zip target=_blank>43v3vvkwwf-1.zip</a></p><p>If that link is now dead (it was alive c.2023) try the Elsevier journal resource page here:
<a href=https://cpc.cs.qub.ac.uk/summaries/AEAS_v1_0.html target=_blank>AEAS_v1_0.html</a></p><p>Unzip the archive to a convenient development folder, and open a bash terminal
in that location. The minimal GNU software you need to install are the GSL library
and the FFTW library. I had trouble getting the <code>fftw3.h</code> header file,
eventually finding a debian package (<code>mffm-fftw-dev</code>) which had it.<br>The apt command I used was</p><div class=highlight><pre aria-label="Box containing code sample." tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo apt install gsl-bin libfftw3-3 mffm-fftw-dev 
</span></span></code></pre></div><p>But you know I have a tonne of other packages installed on my home computer,
so I cannot guarantee you&rsquo;ll get <code>dirac++</code> up and compiling with just those extra packages.</p><p>In the build directory you just unzipped, you should now be able to run,</p><div class=highlight><pre aria-label="Box containing code sample." tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>./compile_fftw3
</span></span></code></pre></div><p>If you get errors for header files not found, then simply try to locate the debian
packages with them included, they have to be around circa 2023, since I managed
a successful compile just back in December 2022.</p><p>You get a whole bunch of ugly compiler warnings, especially from <code>MyMath.h</code> but
just ignore them, or use a less verbose compiler flag for the <code>g++</code>
command in <code>compile_fftw3</code> so for instance remove the <code>-Wall</code> flag.
This is not a good idea if you are the developer, but since we are users of this
code I think it&rsquo;s fine.</p><p>In any case, you should now see the executable named <code>d++</code>.</p><div class=highlight><pre aria-label="Box containing code sample." tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ ls
</span></span><span class=line><span class=cl>compile_fftw2   d++          main.cp   Parameter.h  ReadMe.txt    sample_4a.txt  Spektrum.cp  Vector_Classes.cp
</span></span><span class=line><span class=cl>compile_fftw3   IgorPro.pxp  main.h    Particle.cp  sample_1.txt  sample_4b.txt  Spektrum.h   Vector_Classes.h
</span></span><span class=line><span class=cl>compile_fftw3f  Laser.cp     MatLab.m  Particle.h   sample_2.txt  sample_4c.txt  Threads.cp
</span></span><span class=line><span class=cl>compile_fftw3l  Laser.h      MyMath.h  Prefix.h     sample_3.txt  SampleData     Threads.h
</span></span></code></pre></div><p>The <code>ReadMe.txt</code> file has some bare bones instructions on how to run a simulation.</p><h3 id=pair-production-in-oscillating-em-field><a class=anchor href=#pair-production-in-oscillating-em-field title='Anchor for: Pair Production in Oscillating EM Field.'><svg aria-hidden="true"><use xlink:href="/t4gu/img/bundle.min.fc89b321aa39dfb355170fc007ce5b94.svg#hashtag"/></svg></a>Pair Production in Oscillating EM Field</h3><p>The command to run the &ldquo;sample_3&rdquo; (particle pair production) simulation is,</p><div class=highlight><pre aria-label="Box containing code sample." tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ ./d++ -read<span class=o>=</span>sample_3.txt -dirac &gt; log3.txt <span class=p>&amp;</span>
</span></span></code></pre></div><p>The appended <code>&</code> starts the process off in a hidden shell. It takes a helluva long
time to run. I am not sure, but examining the parameter file I think you can
expect about 750 &ldquo;.bin&rdquo; files to be generated. (1500000 time steps, but updates saved
only every 2000). Total run time was 5 hours 40 minutes.</p><p>You can periodically check progress just by listing the folder, or</p><div class=highlight><pre aria-label="Box containing code sample." tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>ps aux <span class=p>|</span>grep d++
</span></span><span class=line><span class=cl><span class=c1># or </span>
</span></span><span class=line><span class=cl>ps aux <span class=p>|</span>head -n <span class=m>1</span> <span class=o>&amp;&amp;</span> ps aux <span class=p>|</span>grep d++
</span></span></code></pre></div><p>The output files <code>Dirac_x_&lt;index>_density.bin</code> are spewing data output.
They are only about 43K in size, so no need to be alarmed that a lot are generated.
The Elsevier <a href=http://dx.doi.org/10.1016/j.cpc.2008.01.042 target=_blank>journal article</a>
describes
the output formats.
If you do not have an Elsevier subscription, donate a couple of dollars on
<a href=https://ko-fi.com/achrononmaster/ target=_blank>Ko-Fi</a>
to keep me awake and then I can send you the pdf.</p><p>The time increment is <code>1e-07</code> and the final time is <code>0.15</code> so that&rsquo;s a whopping
1.5 million time steps, each time step a bunch of FFT and inverse FFT transforms.
Most modern home computers can handle this, but for starters you might want to
run shorter sims while you figure out how to view the output using free-libre
software, like gnuplot or python matplotlib. So just go and edit the <code>sample3.txt</code>
file and change,</p><pre aria-label="Box containing code sample." tabindex=0><code>#0.15		#final time (in atomic units)
# replace with...
0.05		#final time (in atomic units)
</code></pre><p>The interesting thing about this example is the electron-positron pair get created
right on top of each other, and yet do not spontaneously annihilate. I mean to say&mldr;
did you expect the Dirac equation to say anything different? No. But still,
it&rsquo;s a curious point of note that it is a highly localized phenomenon, and the
T4G account would be a spacetime topology change.</p><p>The other simulations that are previewed in the
<a href=http://dx.doi.org/10.1016/j.cpc.2008.01.042 target=_blank>Mocken and Keitel</a>
article show
similar highly localized spinors. It is hard to look at the results and think of
the Dirac spinors as anything but localized elementary particles.</p><p>You might ask why the heck is that if the &ldquo;wave&rdquo; equations describe ultimate reality.
You already know my answer for that, but there is a nuance.</p><p>The nuance is that the Dirac Theory simulations are for single electrons,
and we know empirically that the more generic case is that electrons will be
entangled, and we know that QM, by pure logic (which is of course backed by
screeds of empirical data) admits only pair-wise entanglement (the exceptions
being rare GHZ states, which are never fully coupled).</p><p>If we were to write software for allowing entanglement to form then the pictures
would be different. We would be able to visualize ER=EPR states and notice how
the coupling yields interference phenomena.
To write software for two-electron systems is beyond my current prowess though,
and the compute demands are certainly beyond my home computer to run.
So this is where I will leave the numerical simulations for now.</p><h3 id=todo><a class=anchor href=#todo title='Anchor for: todo.'><svg aria-hidden="true"><use xlink:href="/t4gu/img/bundle.min.fc89b321aa39dfb355170fc007ce5b94.svg#hashtag"/></svg></a>todo</h3><p>Gotta do some more sims. Guide on visualization with matplotlib.</p><pre aria-label="Box containing code sample." tabindex=0><code>TODO: Work in progress on the visuals.
</code></pre><h2 id=caveats><a class=anchor href=#caveats title='Anchor for: Caveats.'><svg aria-hidden="true"><use xlink:href="/t4gu/img/bundle.min.fc89b321aa39dfb355170fc007ce5b94.svg#hashtag"/></svg></a>Caveats</h2><p>The method described here, and the code, solves the Dirac wave-equation for a
single electron for the given electromagnetic fields, but we have to make the
approximation that the electron has no back-reaction (that would change the fields).
This is a fair enough assumption for most practical circumstances we are likely
to consider.</p><p>I further imagine in 50 years from know the bigger computer labs will have the compute
power to run simulations for whole atoms, with the entanglement. Then we would
have nice visualizations of how entire atoms can be passed through &ldquo;two slits&rdquo;
(more likely around two poles) and see interference patterns.
It would be quite remarkable work, but would be fascinating to understand the
guts of how pair-wise entanglement between the quark pairs and between electrons
is all we need to account for the empirically observed &ldquo;superposition&rdquo;
of whole atoms. Another fifty years after that, being pessimistic about computer
speed-up advances, we might see interference of entire molecules.</p><p>For a T4G enthusiast (or anyone really) that would be a remarkable human
accomplishment.
it would also allow chemists to get more fine grained than their current
state-of-the-art in density functional theory simulations. Who knows what
technological progress that might spur.
Maybe nothing much more other than icecream that doesn&rsquo;t ever get spikey iced-up,
but I&rsquo;m betting a bit more than that.</p><p><a href=./>Next chapter (TBD)</a><br><a href=../099_quantum_logic>Previous chapter (Quantum Logic, Part-1)</a><br><a href=../>Back to Theory TOC</a></p><table style="border-collapse:collapse;border=0"><col span=1 style=width:30%><col span=1 style=width:15%><col span=1 style=width:35%><tr style="border:1px solid color:#0f0f0f"><td style="border:1px solid color:#0f0f0f"><a href=../22_mmtfornow>Previous chapter</a></td><td style="border:1px solid color:#0f0f0f;text-align:center"><a href=../>Back to Posts</a></td><td style="border:1px solid color:#0f0f0f;text-align:right"><a href=../099_quantum_logic>Next chapter</a></td></tr><tr style="border:1px solid color:#0f0f0f"><td style="border:1px solid color:#0f0f0f"><a href=../22_mmtfornow>MMT for Now</a></td><td style="border:1px solid color:#0f0f0f;text-align:center"><a href=../>TOC</a></td><td style="border:1px solid color:#0f0f0f;text-align:right"><a href=../099_quantum_logic>Quantum logic</a></td></tr></table></article></main></div><footer><div class=req-js><button class=outline-dashed title="Change to light/dark mode."><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true"><use xlink:href="/t4gu/img/bundle.min.fc89b321aa39dfb355170fc007ce5b94.svg#adjust"/></svg></button><input class=outline-dashed type=color list=presets value=#26A269 title="Change accent color." aria-label="Change accent color."><datalist id=presets><option value=#1f676b><option value=#26A269><option value=#225670><option value=#dd587c><option value=#902b37><option value=#f3a530><option value=#754e85><option value=#7fc121><option value=#a8314a><option value=#ff7433><option value=#3e6728><option value=#c063bd><option value=#805080><option value=#9d629d><option value=#a064a0><option value=#7daa50><option value=#284531><option value=#285790><option value=#F5A83D><option value=#88aa33><option value=#015660><option value=#bf274e><option value=#bf4242><option value=#51b37c></datalist></div><noscript><p class=noscript>Unable to execute JavaScript. Some features were disabled.</p></noscript></footer><link rel=stylesheet href=https://t4gu.gitlab.io/t4gu/libs/katex@0.16.0/dist/katex.min.6950e59dbd8dfddd111390d85888bb5f9dc2e9c334da7ac1c3bacc92a695610d.css integrity="sha256-aVDlnb2N/d0RE5DYWIi7X53C6cM02nrBw7rMkqaVYQ0=" crossorigin=anonymous><script defer src=https://t4gu.gitlab.io/t4gu/libs/katex@0.16.0/dist/katex.min.0ef45cd8f7b6109cb7d8fd21b5a999fa3a6353d7c8b817b13f24fa66136c32d9.js integrity="sha256-DvRc2Pe2EJy32P0htamZ+jpjU9fIuBexPyT6ZhNsMtk=" crossorigin=anonymous></script><script defer src=https://t4gu.gitlab.io/t4gu/js/katex-custom-render.min.c40a327c961fc9259dd10a48b4276e7e24fcd8baa1a1e028f68273f4cbe8ce8a.js integrity="sha256-xAoyfJYfySWd0QpItCdufiT82LqhoeAo9oJz9Mvozoo=" crossorigin=anonymous></script></body></html>